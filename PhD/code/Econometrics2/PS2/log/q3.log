
. dis (1 + 5*(normal(-1)-normal(1)))
-2.4134475

. set obs 1000
Number of observations (_N) was 0, now 1,000.

. gen e = rnormal(0, 1)

. gen t = rnormal(1, 1)

. egen sat = mean(t)

. scalar sat = sat

. dis sat
.97898465

. cap program drop montecarlo3

. program define montecarlo3, rclass
  1.         cap drop random d x* y*
  2.         gen random = runiform()
  3.         sort random
  4.         gen d = (_n/_N) <= .5
  5.         gen x0  = e > -1
  6.         gen x1  = e > 1
  7.         gen x   = d * x1 + (1 - d) * x0 
  8.         gen y0  = 5 * x0 + e 
  9.         gen y1  = t + 5 * x1 + e
 10.         gen y   = d * y1 + (1 - d) * y0
 11.         qui reg y d
 12.         return scalar tau=_b[d]
 13.         qui reg y d if x == 1
 14.         return scalar tau1=_b[d]
 15.         qui reg y d if x == 0
 16.         return scalar tau0=_b[d]
 17. end

. montecarlo3

. gen te = y1 - y0 

. egen sate = mean(te)

. scalar sate = sate

. dis sate
-2.4010153

. 
. *3bc
. simulate tau = r(tau) tau1 = r(tau1) tau0 = r(tau0), reps(1000): montecarlo3

      Command: montecarlo3
          tau: r(tau)
         tau1: r(tau1)
         tau0: r(tau0)

Simulations (1,000): .........10.........20.........30.........40.........50.........60.........70.........80.........90.........100.........110.........120.........130.........140.........150.........160.........170.........180.........190.........200...
> ......210.........220.........230.........240.........250.........260.........270.........280.........290.........300.........310.........320.........330.........340.........350.........360.........370.........380.........390.........400.........410....
> .....420.........430.........440.........450.........460.........470.........480.........490.........500.........510.........520.........530.........540.........550.........560.........570.........580.........590.........600.........610.........620.....
> ....630.........640.........650.........660.........670.........680.........690.........700.........710.........720.........730.........740.........750.........760.........770.........780.........790.........800.........810.........820.........830......
> ...840.........850.........860.........870.........880.........890.........900.........910.........920.........930.........940.........950.........960.........970.........980.........990.........1,000 done

. tabstat tau*, s(mean) columns(statistics)

    Variable |      Mean
-------------+----------
         tau | -2.404958
        tau1 |   2.24263
        tau0 |    2.1029
------------------------

. 
. *3d
. dis (1 + normalden(1) / (1 - normal(1))) - (normalden(-1) / (1 - normal(-1)))
2.2375353

. dis (1 - normalden(1) / normal(1)) + (normalden(-1) / normal(-1))
2.2375353

. cap log close
