
. *-----------------------------------------------------------------------------*
. 
. *1.5
. set seed 42

. set obs 100
Number of observations (_N) was 0, now 100.

. gen village = _n

. gen fiscal = runiform() > .5

. gen casheffect = rnormal(2,1)

. save data/villages, replace
file data/villages.dta saved

. expand 10
(900 observations created)

. bys village: gen individual = _n

. gen cash = runiform() > .5

. gen po = rnormal(0, 1)

. gen pofiscal = rnormal(1, 1)

. gen pocash = rnormal(casheffect, 1)

. cap program drop createoutcomes

. program define createoutcomes, 
  1.   syntax[, meaninteraction(real 0)]
  2.   keep village - pocash  
  3.   gen interaction = rnormal(`meaninteraction', 0.2)
  4.   gen poboth = pofiscal + pocash + interaction
  5.   gen fiscalcash = fiscal*cash
  6.   gen outcome = (1-fiscal)*(1-cash)*po + fiscal*(1-cash)*pofiscal ///
>   + (1-fiscal)*cash*pocash + fiscalcash*poboth
  7. end

. forval meaninteraction = -1(.2)1 {
  2.         createoutcomes, meaninteraction(`meaninteraction')
  3.         reg outcome fiscal cash, cl(village)
  4.         mat bfiscal1 = [nullmat(bfiscal1) \ _b[fiscal]]
  5.         mat sefiscal1 = [nullmat(sefiscal1) \ _se[fiscal]]
  6.         mat bcash1 = [nullmat(bcash1) \ _b[cash]]
  7.         mat secash1 = [nullmat(secash1) \ _se[cash]]
  8.         reg outcome fiscal cash fiscalcash, cl(village)
  9.         mat bfiscal2 = [nullmat(bfiscal2) \ _b[fiscal]]
 10.         mat sefiscal2 = [nullmat(sefiscal2) \ _se[fiscal]]
 11.         mat bcash2 = [nullmat(bcash2) \ _b[cash]]
 12.         mat secash2 = [nullmat(secash2) \ _se[cash]]
 13.         mat meaninteractions = [nullmat(meaninteractions) \ round(`meaninteraction', .1)]
 14. }

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =      64.96
                                                Prob > F          =     0.0000
                                                R-squared         =     0.2714
                                                Root MSE          =     1.3442

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   .4992246   .1141312     4.37   0.000     .2727636    .7256856
        cash |   1.586779   .1435493    11.05   0.000     1.301945    1.871612
       _cons |   .2739539   .0818675     3.35   0.001      .111511    .4363968
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =      96.03
                                                Prob > F          =     0.0000
                                                R-squared         =     0.2992
                                                Root MSE          =      1.319

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |  -1.049539   .2660914    -3.94   0.000    -1.577522   -.5215555
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =      77.45
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3013
                                                Root MSE          =     1.3328

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   .5881456   .1142832     5.15   0.000     .3613828    .8149083
        cash |   1.676973   .1402319    11.96   0.000     1.398723    1.955224
       _cons |   .2262794   .0801069     2.82   0.006     .0673299    .3852289
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     102.14
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3200
                                                Root MSE          =     1.3155

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |  -.8727769    .265504    -3.29   0.001    -1.399594   -.3459594
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =      93.18
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3366
                                                Root MSE          =     1.3265

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   .6992971   .1146679     6.10   0.000     .4717711    .9268231
        cash |   1.789718   .1377632    12.99   0.000     1.516365     2.06307
       _cons |   .1666861   .0788173     2.11   0.037     .0102955    .3230767
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     110.72
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3467
                                                Root MSE          =     1.3172

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |  -.6518243   .2667127    -2.44   0.016     -1.18104   -.1226085
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     112.11
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3695
                                                Root MSE          =     1.3162

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   .7976237    .114524     6.96   0.000     .5703831    1.024864
        cash |   1.889453   .1342118    14.08   0.000     1.623147    2.155758
       _cons |   .1139689   .0770974     1.48   0.143     -.039009    .2669468
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     119.36
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3742
                                                Root MSE          =     1.3119

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |  -.4563657   .2637122    -1.73   0.087    -.9796279    .0668965
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     125.50
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3990
                                                Root MSE          =     1.3198

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   .9027368   .1157219     7.80   0.000     .6731194    1.132354
        cash |   1.996072   .1346401    14.83   0.000     1.728917    2.263227
       _cons |    .057613   .0774073     0.74   0.458    -.0959799     .211206
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     128.22
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4003
                                                Root MSE          =      1.319

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |  -.2474164   .2672457    -0.93   0.357    -.7776898    .2828571
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     140.54
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4282
                                                Root MSE          =     1.3213

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.007512   .1171962     8.60   0.000     .7749695    1.240055
        cash |   2.102349   .1346986    15.61   0.000     1.835077     2.36962
       _cons |   .0014383    .077629     0.02   0.985    -.1525945    .1554711
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     136.92
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4282
                                                Root MSE          =     1.3219

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |  -.0391385   .2684534    -0.15   0.884    -.5718083    .4935313
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     163.53
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4575
                                                Root MSE          =     1.3142

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.104269   .1159679     9.52   0.000      .874164    1.334375
        cash |   2.200492   .1330104    16.54   0.000     1.936571    2.464414
       _cons |  -.0504376   .0770736    -0.65   0.514    -.2033684    .1024932
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     151.04
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4579
                                                Root MSE          =     1.3143

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |   .1532006   .2648017     0.58   0.564    -.3722234    .6786245
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     180.27
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4821
                                                Root MSE          =     1.3179

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.202393   .1166002    10.31   0.000     .9710326    1.433753
        cash |   2.300021   .1337344    17.20   0.000     2.034663    2.565379
       _cons |  -.1030458   .0777667    -1.33   0.188    -.2573518    .0512601
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     162.68
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4843
                                                Root MSE          =     1.3157

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |   .3482549   .2644214     1.32   0.191    -.1764144    .8729243
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     185.75
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5053
                                                Root MSE          =     1.3238

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.302642   .1194111    10.91   0.000     1.065705     1.53958
        cash |   2.401707   .1375473    17.46   0.000     2.128784    2.674631
       _cons |  -.1567942   .0800255    -1.96   0.053    -.3155822    .0019939
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     169.48
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5106
                                                Root MSE          =     1.3174

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |   .5475364   .2686306     2.04   0.044      .014515    1.080558
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     207.64
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5281
                                                Root MSE          =     1.3309

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.407962    .119113    11.82   0.000     1.171616    1.644308
        cash |   2.508536   .1383999    18.13   0.000      2.23392    2.783151
       _cons |  -.2132606   .0809614    -2.63   0.010    -.3739055   -.0526156
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     186.75
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5377
                                                Root MSE          =      1.318

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |   .7568956   .2653595     2.85   0.005     .2303648    1.283426
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     223.16
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5486
                                                Root MSE          =     1.3386

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.509399   .1190875    12.67   0.000     1.273104    1.745695
        cash |   2.611426    .141393    18.47   0.000     2.330872    2.891981
       _cons |  -.2676456   .0829708    -3.23   0.002    -.4322777   -.1030136
------------------------------------------------------------------------------

Linear regression                               Number of obs     =      1,000
                                                F(3, 99)          =     204.34
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5631
                                                Root MSE          =     1.3177

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.027201   .0928082    11.07   0.000     .8430494    1.211353
        cash |    2.12232   .1718513    12.35   0.000     1.781329     2.46331
  fiscalcash |    .958538   .2650834     3.62   0.000      .432555    1.484521
       _cons |  -.0091178   .0616944    -0.15   0.883     -.131533    .1132974
------------------------------------------------------------------------------

. 
. *1.6
. forval val = 1/2 {
  2.         foreach var in fiscal cash {
  3.                 mat lower`var'`val' = b`var'`val' - 1.96*se`var'`val'
  4.                 mat upper`var'`val' = b`var'`val' + 1.96*se`var'`val'
  5.         }
  6. }

. forval val = 1/2 {
  2.         foreach var in fiscal cash {
  3.                 svmat b`var'`val'
  4.                 svmat lower`var'`val'
  5.                 svmat upper`var'`val'
  6.         }
  7. }

. svmat meaninteractions

. forval val = 1/2 {
  2. twoway (rcap upperfiscal`val' lowerfiscal`val' meaninteractions) ///
> (connected bfiscal`val' meaninteractions) (rcap uppercash`val' lowercash`val' meaninteractions) ///
> (connected bcash`val' meaninteractions, yaxis(1 2)), yline(1, axis(2)) yline(2, axis(2)) ///
> legend(order(1 "ATEhat fiscal" 2 "ATEhat cash") position(6) row(1)) ///
> xtitle("mean interaction") ylabel(1 "ATE fiscal" 2 "ATE cash") name(ate`val', replace)
  3. }

. graph combine ate1 ate2

. graph export output/6.png, replace 
file output/6.png saved as PNG format

. 
. *1.7
. eststo clear

. forval meaninteraction = 0/1 {
  2.   qui createoutcomes, meaninteraction(`meaninteraction')
  3.   eststo: reg outcome fiscal cash, cl(village)
  4.   eststo: reghdfe outcome cash, absorb(village) cluster(village)
  5. }

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     143.26
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4302
                                                Root MSE          =     1.3198

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.012562   .1164006     8.70   0.000     .7815982    1.243526
        cash |   2.107471   .1342541    15.70   0.000     1.841082     2.37386
       _cons |  -.0012693   .0774252    -0.02   0.987    -.1548977    .1523592
------------------------------------------------------------------------------
(est1 stored)
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =      1,000
Absorbing 1 HDFE group                            F(   1,     99) =     230.34
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.5387
                                                  Adj R-squared   =     0.4874
                                                  Within R-sq.    =     0.4133
Number of clusters (village) =        100         Root MSE        =     1.2506

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        cash |   2.102815   .1385527    15.18   0.000     1.827897    2.377734
       _cons |   .5174745   .0695535     7.44   0.000     .3794654    .6554837
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     village |       100         100           0    *|
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(est2 stored)

Linear regression                               Number of obs     =      1,000
                                                F(2, 99)          =     219.82
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5496
                                                Root MSE          =       1.34

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      fiscal |   1.515718   .1200452    12.63   0.000     1.277523    1.753914
        cash |   2.617836   .1422463    18.40   0.000     2.335589    2.900084
       _cons |  -.2710337   .0834156    -3.25   0.002    -.4365482   -.1055191
------------------------------------------------------------------------------
(est3 stored)
(MWFE estimator converged in 1 iterations)

HDFE Linear regression                            Number of obs   =      1,000
Absorbing 1 HDFE group                            F(   1,     99) =     333.69
Statistics robust to heteroskedasticity           Prob > F        =     0.0000
                                                  R-squared       =     0.6381
                                                  Adj R-squared   =     0.5979
                                                  Within R-sq.    =     0.5160
Number of clusters (village) =        100         Root MSE        =     1.2648

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
        cash |   2.616252   .1432223    18.27   0.000     2.332068    2.900437
       _cons |   .5027776   .0718976     6.99   0.000     .3601172    .6454381
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     village |       100         100           0    *|
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation
(est4 stored)

. esttab using output/7.tex,  keep(fiscal cash) replace
(output written to output/7.tex)

.         
. *1.8
. qui createoutcomes, meaninteraction(0)

. gen cashvillage = cash*village

. reghdfe outcome i.cashvillage, absorb(village) cluster(village) nocons
(MWFE estimator converged in 1 iterations)
warning: missing F statistic; dropped variables due to collinearity or too few clusters

HDFE Linear regression                            Number of obs   =      1,000
Absorbing 1 HDFE group                            F( 100,     99) =          .
Statistics robust to heteroskedasticity           Prob > F        =          .
                                                  R-squared       =     0.6797
                                                  Adj R-squared   =     0.6001
                                                  Within R-sq.    =     0.5908
Number of clusters (village) =        100         Root MSE        =     1.1025

                              (Std. err. adjusted for 100 clusters in village)
------------------------------------------------------------------------------
             |               Robust
     outcome | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
 cashvillage |
          1  |  -.2519655   8.17e-16 -3.1e+14   0.000    -.2519655   -.2519655
          2  |   .6486503   1.65e-15  3.9e+14   0.000     .6486503    .6486503
          3  |    .419822   1.98e-16  2.1e+15   0.000      .419822     .419822
          4  |   1.514426   6.25e-16  2.4e+15   0.000     1.514426    1.514426
          5  |    .635456   1.40e-15  4.5e+14   0.000      .635456     .635456
          6  |   1.740636   1.97e-15  8.9e+14   0.000     1.740636    1.740636
          7  |   1.116605   7.39e-16  1.5e+15   0.000     1.116605    1.116605
          8  |    5.30158   2.37e-16  2.2e+16   0.000      5.30158     5.30158
          9  |   2.733224   2.65e-15  1.0e+15   0.000     2.733224    2.733224
         10  |   1.694548   2.57e-16  6.6e+15   0.000     1.694548    1.694548
         11  |    1.81012   2.00e-16  9.0e+15   0.000      1.81012     1.81012
         12  |   2.870504   6.74e-16  4.3e+15   0.000     2.870504    2.870504
         13  |   1.394961   1.89e-16  7.4e+15   0.000     1.394961    1.394961
         14  |   .2850714   1.62e-17  1.8e+16   0.000     .2850714    .2850714
         15  |   1.117079   1.15e-16  9.7e+15   0.000     1.117079    1.117079
         16  |  -1.755548   1.32e-16 -1.3e+16   0.000    -1.755548   -1.755548
         17  |   2.564186   3.27e-16  7.8e+15   0.000     2.564186    2.564186
         18  |   2.211606   1.41e-15  1.6e+15   0.000     2.211606    2.211606
         19  |    1.63352   2.16e-17  7.6e+16   0.000      1.63352     1.63352
         20  |  -.9757442   7.75e-17 -1.3e+16   0.000    -.9757442   -.9757442
         21  |   .8901843   1.61e-17  5.5e+16   0.000     .8901843    .8901843
         22  |   2.448412   4.75e-16  5.2e+15   0.000     2.448412    2.448412
         23  |   1.999855   1.68e-16  1.2e+16   0.000     1.999855    1.999855
         24  |   3.529332   1.51e-16  2.3e+16   0.000     3.529332    3.529332
         25  |   5.380382   1.08e-15  5.0e+15   0.000     5.380382    5.380382
         26  |   2.657762   1.79e-15  1.5e+15   0.000     2.657762    2.657762
         27  |   1.306294   3.72e-16  3.5e+15   0.000     1.306294    1.306294
         28  |   2.322361   4.44e-16  5.2e+15   0.000     2.322361    2.322361
         29  |   2.766869   2.17e-17  1.3e+17   0.000     2.766869    2.766869
         30  |   1.807286   5.58e-16  3.2e+15   0.000     1.807286    1.807286
         31  |  -1.632543   1.66e-16 -9.8e+15   0.000    -1.632543   -1.632543
         32  |   1.725048   9.44e-17  1.8e+16   0.000     1.725048    1.725048
         33  |   4.137882   9.98e-16  4.1e+15   0.000     4.137882    4.137882
         34  |   3.255395   1.91e-16  1.7e+16   0.000     3.255395    3.255395
         35  |   5.235529   1.11e-15  4.7e+15   0.000     5.235529    5.235529
         36  |   4.432299   3.46e-16  1.3e+16   0.000     4.432299    4.432299
         37  |   3.545647   2.38e-16  1.5e+16   0.000     3.545647    3.545647
         38  |   4.246269   1.31e-15  3.2e+15   0.000     4.246269    4.246269
         39  |   1.160994   2.16e-16  5.4e+15   0.000     1.160994    1.160994
         40  |   3.249572   5.26e-16  6.2e+15   0.000     3.249572    3.249572
         41  |   2.691579   1.27e-15  2.1e+15   0.000     2.691579    2.691579
         42  |   2.599197   1.15e-15  2.3e+15   0.000     2.599197    2.599197
         43  |   3.248288   1.06e-15  3.1e+15   0.000     3.248288    3.248288
         44  |   2.817242   7.24e-17  3.9e+16   0.000     2.817242    2.817242
         45  |   .8754295   2.31e-16  3.8e+15   0.000     .8754295    .8754295
         46  |   2.490441   4.42e-16  5.6e+15   0.000     2.490441    2.490441
         47  |   2.601405   8.15e-17  3.2e+16   0.000     2.601405    2.601405
         48  |  -.3305369   4.44e-17 -7.4e+15   0.000    -.3305369   -.3305369
         49  |   3.183808   9.00e-16  3.5e+15   0.000     3.183808    3.183808
         50  |   .4421195   2.12e-16  2.1e+15   0.000     .4421195    .4421195
         51  |   3.703597   2.19e-16  1.7e+16   0.000     3.703597    3.703597
         52  |   1.965669   9.26e-17  2.1e+16   0.000     1.965669    1.965669
         53  |   2.852285   7.53e-16  3.8e+15   0.000     2.852285    2.852285
         54  |   4.006495   4.21e-16  9.5e+15   0.000     4.006495    4.006495
         55  |   .3779708   1.63e-17  2.3e+16   0.000     .3779708    .3779708
         56  |    1.62432   8.82e-17  1.8e+16   0.000      1.62432     1.62432
         57  |   3.036735   1.56e-16  1.9e+16   0.000     3.036735    3.036735
         58  |    .528274   8.68e-18  6.1e+16   0.000      .528274     .528274
         59  |   2.903936   1.16e-16  2.5e+16   0.000     2.903936    2.903936
         60  |  -.5810311   2.10e-16 -2.8e+15   0.000    -.5810311   -.5810311
         61  |   1.918054   1.91e-16  1.0e+16   0.000     1.918054    1.918054
         62  |   3.031955   5.34e-16  5.7e+15   0.000     3.031955    3.031955
         63  |   1.700637   2.78e-16  6.1e+15   0.000     1.700637    1.700637
         64  |   1.500088   4.33e-17  3.5e+16   0.000     1.500088    1.500088
         65  |   1.051466   1.91e-16  5.5e+15   0.000     1.051466    1.051466
         66  |   3.617468   1.86e-15  1.9e+15   0.000     3.617468    3.617468
         67  |   3.382502   5.07e-16  6.7e+15   0.000     3.382502    3.382502
         68  |   3.279076   6.00e-16  5.5e+15   0.000     3.279076    3.279076
         69  |   1.286212   3.28e-16  3.9e+15   0.000     1.286212    1.286212
         70  |   2.639116   2.04e-17  1.3e+17   0.000     2.639116    2.639116
         71  |   2.597146   7.88e-16  3.3e+15   0.000     2.597146    2.597146
         72  |   2.488532   6.68e-16  3.7e+15   0.000     2.488532    2.488532
         73  |   2.451899   6.23e-16  3.9e+15   0.000     2.451899    2.451899
         74  |   1.242057   5.29e-17  2.3e+16   0.000     1.242057    1.242057
         75  |   3.513593   3.15e-16  1.1e+16   0.000     3.513593    3.513593
         76  |   2.853442   5.72e-16  5.0e+15   0.000     2.853442    2.853442
         77  |   3.201452   6.54e-16  4.9e+15   0.000     3.201452    3.201452
         78  |   2.582567   3.99e-16  6.5e+15   0.000     2.582567    2.582567
         79  |   2.366299   8.39e-17  2.8e+16   0.000     2.366299    2.366299
         80  |   1.414281   3.13e-16  4.5e+15   0.000     1.414281    1.414281
         81  |   .6490483   2.14e-16  3.0e+15   0.000     .6490483    .6490483
         82  |   .7713091   1.06e-16  7.3e+15   0.000     .7713091    .7713091
         83  |   2.200601   1.40e-16  1.6e+16   0.000     2.200601    2.200601
         84  |   1.567714   6.87e-16  2.3e+15   0.000     1.567714    1.567714
         85  |   .5099936   6.95e-17  7.3e+15   0.000     .5099936    .5099936
         86  |   2.382346   6.71e-16  3.5e+15   0.000     2.382346    2.382346
         87  |   .5354699   5.29e-17  1.0e+16   0.000     .5354699    .5354699
         88  |   3.749823   2.37e-15  1.6e+15   0.000     3.749823    3.749823
         89  |   2.085331   2.64e-16  7.9e+15   0.000     2.085331    2.085331
         90  |  -.1156306   1.19e-16 -9.7e+14   0.000    -.1156306   -.1156306
         91  |   2.372674   3.26e-17  7.3e+16   0.000     2.372674    2.372674
         92  |   1.140382   1.50e-16  7.6e+15   0.000     1.140382    1.140382
         93  |   2.524243   3.80e-17  6.6e+16   0.000     2.524243    2.524243
         94  |   .7982877   2.89e-16  2.8e+15   0.000     .7982877    .7982877
         95  |   3.207103   4.36e-16  7.4e+15   0.000     3.207103    3.207103
         96  |   1.991124   3.80e-16  5.2e+15   0.000     1.991124    1.991124
         97  |   4.637282   8.38e-16  5.5e+15   0.000     4.637282    4.637282
         98  |   1.148897   4.17e-16  2.8e+15   0.000     1.148897    1.148897
         99  |   3.288548   7.66e-16  4.3e+15   0.000     3.288548    3.288548
        100  |   2.061674   1.27e-16  1.6e+16   0.000     2.061674    2.061674
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
     village |       100         100           0    *|
-----------------------------------------------------+
* = FE nested within cluster; treated as redundant for DoF computation

. preserve

. regsave

. keep var coef

. drop if var == "0b.cashvillage" 
(1 observation deleted)

. gen village = subinstr(var, ".cashvillage", "", .)

. destring village, replace
village: all characters numeric; replaced as byte

. drop var

. merge 1:1 village using data/villages, nogen
(variable village was byte, now float to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               100  
    -----------------------------------------

. sum coef, d

                         Coefficient
-------------------------------------------------------------
      Percentiles      Smallest
 1%    -1.694046      -1.755548
 5%    -.2912512      -1.632543
10%     .4309707      -.9757442       Obs                 100
25%      1.14464      -.5810311       Sum of wgt.         100

50%     2.206104                      Mean           2.078349
                        Largest       Std. dev.      1.401073
75%     2.967946       4.637282
90%     3.660533       5.235529       Variance       1.963006
95%     4.339284        5.30158       Skewness      -.1768792
99%     5.340981       5.380382       Kurtosis         3.2281

. twoway (scatter coef casheffect)

. graph export output/8.png, replace
file output/8.png saved as PNG format

. restore 

. 
. *1.9
. sum cash

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        cash |      1,000        .502    .5002462          0          1

. scalar cashpropensity = `r(mean)'

. scalar cashvariance = `=cashpropensity' * (1-`=cashpropensity')

. scalar villagers = 10

. qui createoutcomes, meaninteraction(0)

. gen cashvillage = cash*village

. qui reghdfe outcome, absorb(village cashvillage)

. scalar withinvar = `e(rmse)'^2 

. qui reghdfe outcome i.cashvillage, absorb(village) cluster(village) nocons resid 

. regsave 

. keep var coef

. drop if var == "0b.cashvillage" 
(1 observation deleted)

. gen village = subinstr(var, ".cashvillage", "", .)

. destring village, replace
village: all characters numeric; replaced as byte

. drop var

. merge 1:1 village using data/villages, nogen
(variable village was byte, now float to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               100  
    -----------------------------------------

. sum coef, d

                         Coefficient
-------------------------------------------------------------
      Percentiles      Smallest
 1%    -1.799858      -1.892496
 5%    -.2934993       -1.70722
10%     .4344528      -.9757442       Obs                 100
25%     1.154946      -.8003566       Sum of wgt.         100

50%     2.234499                      Mean           2.075658
                        Largest       Std. dev.       1.40714
75%     3.040871       4.732461
90%     3.660533       5.235529       Variance       1.980042
95%     4.326413        5.30158       Skewness       -.226029
99%     5.340981       5.380382       Kurtosis       3.332517

. scalar prior = `r(mean)'

. dis `=prior'
2.0756578

. reg coef

      Source |       SS           df       MS      Number of obs   =       100
-------------+----------------------------------   F(0, 99)        =      0.00
       Model |           0         0           .   Prob > F        =         .
    Residual |  196.024159        99  1.98004201   R-squared       =    0.0000
-------------+----------------------------------   Adj R-squared   =    0.0000
       Total |  196.024159        99  1.98004201   Root MSE        =    1.4071

------------------------------------------------------------------------------
        coef | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
       _cons |   2.075658    .140714    14.75   0.000     1.796451    2.354865
------------------------------------------------------------------------------

. scalar overdispersion = `e(rmse)'^2 - `=withinvar'/(`=villagers'*`=cashvariance')

. scalar signaltonoise = `=overdispersion'/(`=overdispersion' +`=withinvar'/(`=villagers'*`=cashvariance'))

. dis `=signaltonoise'
.75524604

. gen posterior = `=prior' + `=signaltonoise' * (coef-`=prior')

. sum posterior

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
   posterior |        100    2.075658    1.062737  -.9212744   4.571537

. egen msecoef = total(1/10*(coef - casheffect)^2)

. egen mseposterior = total(1/10*(posterior - casheffect)^2)

. sum mse*

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
     msecoef |        100    5.844481           0   5.844481   5.844481
mseposterior |        100    3.172216           0   3.172216   3.172216

. twoway (pcarrow coef casheffect posterior casheffect) ///
> (scatter coef casheffect, m(x) msize(0.5)),  yline(`=prior') legend(position(6) row(1))

. graph export output/9.png, replace
file output/9.png saved as PNG format

. 
. *-----------------------------------------------------------------------------*/
. clear all

. 
. *2.5
. set seed 42

. set obs 200
Number of observations (_N) was 0, now 200.

. gen period = _n

. gen gamma = rnormal(0, sqrt(.5))

. expand 10
(1,800 observations created)

. bys period: gen worker = _n

. bys worker: gen alpha = rnormal(0,1)

. replace alpha = alpha[_n-1] if worker == worker[_n-1]
(1,990 real changes made)

. gen machine = runiformint(1, 20)

. bys machine: gen psi = rnormal(1,1) 

. replace psi = psi[_n-1] if machine == machine[_n-1]
(1,980 real changes made)

. gen epsilon = rnormal(1, sqrt(.2))

. gen output = alpha + gamma + psi + epsilon

. save data/output, replace
file data/output.dta saved

. 
. *2.6
. reghdfe output i.worker, absorb(period machine) nocons
(MWFE estimator converged in 7 iterations)

HDFE Linear regression                            Number of obs   =      2,000
Absorbing 2 HDFE groups                           F(   9,   1772) =    1044.90
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.9240
                                                  Adj R-squared   =     0.9143
                                                  Within R-sq.    =     0.8414
                                                  Root MSE        =     0.4306

------------------------------------------------------------------------------
      output | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      worker |
          2  |   -2.86555   .0433522   -66.10   0.000    -2.950577   -2.780524
          3  |  -1.155354   .0434122   -26.61   0.000    -1.240499    -1.07021
          4  |  -2.782256   .0434817   -63.99   0.000    -2.867537   -2.696975
          5  |  -3.309332   .0433527   -76.34   0.000     -3.39436   -3.224305
          6  |  -1.691358    .043246   -39.11   0.000    -1.776176   -1.606539
          7  |  -1.929163   .0434593   -44.39   0.000      -2.0144   -1.843926
          8  |  -1.920769   .0434155   -44.24   0.000     -2.00592   -1.835618
          9  |  -2.757931   .0433079   -63.68   0.000    -2.842871   -2.672991
         10  |   -1.39245   .0433696   -32.11   0.000    -1.477511    -1.30739
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
      period |       200           0         200     |
     machine |        20           1          19     |
-----------------------------------------------------+

. regsave

. drop if var == "1b.worker"
(1 observation deleted)

. gen worker = subinstr(var, ".worker", "", .)

. destring worker, replace
worker: all characters numeric; replaced as byte

. merge 1:m worker using data/output, nogen
(variable worker was byte, now float to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                           200
        from master                         0  
        from using                        200  

    Matched                             1,800  
    -----------------------------------------

. twoway (scatter coef alpha) in 1/9, name(alpha6, replace)

. 
. use data/output, clear

. reghdfe output i.machine, absorb(period worker) nocons
(MWFE estimator converged in 2 iterations)

HDFE Linear regression                            Number of obs   =      2,000
Absorbing 2 HDFE groups                           F(  19,   1772) =     374.32
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.9240
                                                  Adj R-squared   =     0.9143
                                                  Within R-sq.    =     0.8005
                                                  Root MSE        =     0.4306

------------------------------------------------------------------------------
      output | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
     machine |
          2  |   -2.07317    .064513   -32.14   0.000      -2.1997   -1.946641
          3  |  -.5361678   .0633734    -8.46   0.000    -.6604622   -.4118734
          4  |   -1.00534   .0658571   -15.27   0.000    -1.134505    -.876174
          5  |  -.2728387   .0651285    -4.19   0.000    -.4005754    -.145102
          6  |  -1.963512   .0638318   -30.76   0.000    -2.088706   -1.838319
          7  |  -1.975926   .0661652   -29.86   0.000    -2.105696   -1.846156
          8  |  -.6528535   .0670637    -9.73   0.000    -.7843858   -.5213213
          9  |  -.7379377   .0673474   -10.96   0.000    -.8700264    -.605849
         10  |  -.4994337    .064816    -7.71   0.000    -.6265575   -.3723099
         11  |   -1.82765   .0624235   -29.28   0.000    -1.950082   -1.705219
         12  |  -.1447019   .0674291    -2.15   0.032    -.2769508   -.0124529
         13  |   -1.77443   .0647488   -27.40   0.000    -1.901422   -1.647438
         14  |  -.0556997   .0668244    -0.83   0.405    -.1867626    .0753631
         15  |  -3.469693   .0662207   -52.40   0.000    -3.599572   -3.339814
         16  |   -1.43291   .0660497   -21.69   0.000    -1.562453   -1.303366
         17  |  -1.228144   .0638243   -19.24   0.000    -1.353322   -1.102965
         18  |  -.5933756   .0657189    -9.03   0.000    -.7222704   -.4644808
         19  |  -1.223143   .0643534   -19.01   0.000     -1.34936   -1.096927
         20  |  -.2443146   .0652708    -3.74   0.000    -.3723305   -.1162988
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
      period |       200           0         200     |
      worker |        10           1           9     |
-----------------------------------------------------+

. scalar obs=`e(df_m)'

. regsave

. drop if var == "1b.machine"
(1 observation deleted)

. gen machine = subinstr(var, ".machine", "", .)

. destring machine, replace
machine: all characters numeric; replaced as byte

. merge 1:m machine using data/output, nogen
(variable machine was byte, now float to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                            97
        from master                         0  
        from using                         97  

    Matched                             1,903  
    -----------------------------------------

. twoway (scatter coef psi) in 1/`=obs', name(psi6, replace)

. graph combine alpha6 psi6

. graph export output/fe6.png, replace
file output/fe6.png saved as PNG format

. 
. *2.7
. clear all

. set seed 42

. set obs 5
Number of observations (_N) was 0, now 5.

. gen period = _n

. gen gamma = rnormal(0, sqrt(.5))

. expand 10
(45 observations created)

. bys period: gen worker = _n

. bys worker: gen alpha = rnormal(0,1)

. replace alpha = alpha[_n-1] if worker == worker[_n-1]
(40 real changes made)

. gen machine = runiformint(1, 20)

. bys machine: gen psi = rnormal(1,1) 

. replace psi = psi[_n-1] if machine == machine[_n-1]
(33 real changes made)

. gen epsilon = rnormal(1, sqrt(.2))

. gen output = alpha + gamma + psi + epsilon

. save data/output2, replace
file data/output2.dta saved

. 
. reghdfe output i.worker, absorb(period machine) nocons
(dropped 4 singleton observations)
(MWFE estimator converged in 6 iterations)

HDFE Linear regression                            Number of obs   =         46
Absorbing 2 HDFE groups                           F(   9,     20) =      16.92
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.9685
                                                  Adj R-squared   =     0.9290
                                                  Within R-sq.    =     0.8839
                                                  Root MSE        =     0.4615

------------------------------------------------------------------------------
      output | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
      worker |
          2  |  -.1114621   .3799383    -0.29   0.772    -.9039994    .6810753
          3  |  -.7728502   .4410412    -1.75   0.095    -1.692846    .1471457
          4  |   -.640862   .4359725    -1.47   0.157    -1.550285    .2685606
          5  |  -.2807048   .4004365    -0.70   0.491    -1.116001     .554591
          6  |   1.070381   .4385552     2.44   0.024     .1555706    1.985191
          7  |   2.094227   .4410528     4.75   0.000     1.174207    3.014247
          8  |     1.5324   .4077002     3.76   0.001     .6819525    2.382848
          9  |   2.611341   .4536063     5.76   0.000     1.665134    3.557547
         10  |   .2143698   .4433286     0.48   0.634    -.7103976    1.139137
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
      period |         5           0           5     |
     machine |        13           1          12     |
-----------------------------------------------------+

. regsave

. drop if var == "1b.worker"
(1 observation deleted)

. gen worker = subinstr(var, ".worker", "", .)

. destring worker, replace
worker: all characters numeric; replaced as byte

. merge 1:m worker using data/output2, nogen
(variable worker was byte, now float to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             5
        from master                         0  
        from using                          5  

    Matched                                45  
    -----------------------------------------

. twoway (scatter coef alpha) in 1/9, name(alpha7, replace)

. 
. use data/output2, clear

. reghdfe output i.machine, absorb(period worker) nocons
(MWFE estimator converged in 2 iterations)

HDFE Linear regression                            Number of obs   =         50
Absorbing 2 HDFE groups                           F(  16,     20) =       8.44
                                                  Prob > F        =     0.0000
                                                  R-squared       =     0.9700
                                                  Adj R-squared   =     0.9266
                                                  Within R-sq.    =     0.8710
                                                  Root MSE        =     0.4615

------------------------------------------------------------------------------
      output | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]
-------------+----------------------------------------------------------------
     machine |
          3  |   .5722122   .7677068     0.75   0.465    -1.029196     2.17362
          4  |  -.6931598   .6443872    -1.08   0.295    -2.037328    .6510083
          5  |   2.098722   .7897182     2.66   0.015     .4513988    3.746045
          6  |   1.717977   .6114656     2.81   0.011     .4424817    2.993472
          7  |  -.1893167   .6237916    -0.30   0.765    -1.490523     1.11189
          8  |  -1.716061   .8832726    -1.94   0.066    -3.558535    .1264134
          9  |   .7949108   .6101526     1.30   0.207    -.4778451    2.067667
         10  |   .5732836   .6935475     0.83   0.418    -.8734311    2.019998
         11  |  -1.135159   .7261124    -1.56   0.134    -2.649803    .3794851
         12  |  -.4816933   .8535203    -0.56   0.579    -2.262105    1.298719
         13  |   .3093437   .6805584     0.45   0.654    -1.110276    1.728964
         14  |  -.8050346   .6100002    -1.32   0.202    -2.077473    .4674036
         15  |   .2035088   .6873317     0.30   0.770     -1.23024    1.637258
         16  |   .9385502   .7876624     1.19   0.247    -.7044849    2.581585
         17  |   .2333841   .7130176     0.33   0.747    -1.253945    1.720713
         19  |  -.7696269   .7464181    -1.03   0.315    -2.326628    .7873741
------------------------------------------------------------------------------

Absorbed degrees of freedom:
-----------------------------------------------------+
 Absorbed FE | Categories  - Redundant  = Num. Coefs |
-------------+---------------------------------------|
      period |         5           0           5     |
      worker |        10           1           9     |
-----------------------------------------------------+

. scalar obs=`e(df_m)'

. regsave

. drop if var == "1b.machine" 
(1 observation deleted)

. gen machine = subinstr(var, ".machine", "", .)

. destring machine, replace
machine: all characters numeric; replaced as byte

. sum machine

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
     machine |         16     10.5625    4.871259          3         19

. merge 1:m machine using data/output2, nogen
(variable machine was byte, now float to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             1
        from master                         0  
        from using                          1  

    Matched                                49  
    -----------------------------------------

. twoway (scatter coef psi) in 1/`=obs', name(psi7, replace)

. graph combine alpha7 psi7

. graph export output/fe7.png, replace
file output/fe7.png saved as PNG format

. log close
      name:  <unnamed>
       log:  C:\Users\chadi\OneDrive - Handelshögskolan i Stockholm\SU\EC38003\assignments\PS4\log/ps4.log
  log type:  text
 closed on:   6 May 2024, 15:41:10
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
