############################################################################################################################/
##################### Problem Set: Week 2 ###############################################################################
############################################################################################################################/
# 14.750x: Political Economy and Economic Development
############################################################################################################################/

#**************************************************************************************************************************/
# 0. Initial adjustment and necessary package loading ----------------------------------------------------------------
#**************************************************************************************************************************/

options(scipen=999)
options(max.print = 99999999)
rm(list=(ls()))

library(rio)
library(dplyr)
library(tidyr)
library(ggplot2)


getwd()
AssassinationsData <- import("AssassinationsData.rdata")


#*****************************************************************************/
# 2.a  ----------------------------------------------------------------
#*****************************************************************************/
## i. 
df1900 <- AssassinationsData %>% filter(year==1900)
summary(df1900$npolity2dummy)

## ii.
df2000 <- AssassinationsData %>% filter(year==2000)
summary(df2000$npolity2dummy)

## iii.
df1945 <- AssassinationsData %>% filter(year==1945)
summary(df1945$absnpolity2dummy11)

## iv.
df1980 <- AssassinationsData %>% filter(year==1980)
summary(df1980$absnpolity2dummy11)


#*****************************************************************************/
# 2.b  ----------------------------------------------------------------
#*****************************************************************************/

seriousAttempt <- AssassinationsData%>% filter(seriousattempt==1)

lm <- lm(absnpolity2dummy11~success, data = seriousAttempt)
summary(lm)


#*****************************************************************************/
# 2.d  ----------------------------------------------------------------
#*****************************************************************************/

confint(lm,"success",level=.95)


#*****************************************************************************/
# 2.e  ----------------------------------------------------------------
#*****************************************************************************/

summary(lm)


#*****************************************************************************/
# 3. ----------------------------------------------------------------
#*****************************************************************************/

lmfe <- lm(absnpolity2dummy11~success+weapondum2+weapondum3+weapondum4+
             weapondum5+weapondum6, data = seriousAttempt)
summary(lmfe)


#*****************************************************************************/
# 3.c ----------------------------------------------------------------
#*****************************************************************************/

confint(lmfe,"success",level=.95)






